import{d as b,r as o,a as y,B as S,j as e}from"./index-BJo3Wz4H.js";import I from"./PageError-BJADJKHu.js";import{V as w,c as N,I as C}from"./ApiLogin-BT0YSUyN.js";import{d as T}from"./Email-GPpTofqF.js";import{S as R}from"./createSvgIcon-BuLzkb-N.js";import{F as E}from"./TextField-DwvuUxNR.js";import{B as p}from"./Button-BuZ00tsX.js";import"./instance-CBuQ1cLn.js";import"./AxiosConfigHeader-CNHt4vQr.js";import"./styled-CJA13E1M.js";import"./createSvgIcon-ho_PURcI.js";import"./useId-DYJmAM81.js";import"./useIsFocusVisible-BCA3twK2.js";import"./useControlled-Bs3ZyH6M.js";import"./mergeSlotProps-CKWnQtuB.js";import"./ButtonBase-Bpx5dE4Z.js";import"./index-vBsn1U4B.js";import"./Grow-Bq5RsNA9.js";function K(){const g=b();o.useState(null);const[a,n]=o.useState(300),[l,m]=o.useState(!1),[h,D]=o.useState(!0);try{const{email:i,username:c}=g.state,d=y(),j=async t=>{t.preventDefault();const r=t.target[0].value,s=await w(r);console.log(s),s<400&&(localStorage.removeItem("expiryTime"),localStorage.removeItem("currentUser"),d("/login",{replace:!0}))},v=async()=>{const t=Date.now()+3e5;await N()==200?(localStorage.setItem("expiryTime",t),n(30)):(S.info("Register again to verify the code"),d("/login",{replace:!0}))};o.useEffect(()=>{if(localStorage.getItem("currentUser")==null)localStorage.setItem("currentUser",JSON.stringify({email:i,username:c}));else{const r=JSON.parse(localStorage.getItem("currentUser"));r.email==i&&r.username==c||localStorage.removeItem("expiryTime")}const t=localStorage.getItem("expiryTime");if(t){const r=Date.now(),s=Math.max(0,Math.floor((t-r)/1e3));if(n(s),s>0){const u=setInterval(()=>{n(x=>x<=1?(clearInterval(u),0):x-1)},1e3);return()=>clearInterval(u)}}else{const r=Date.now()+3e5;localStorage.setItem("expiryTime",r),n(300)}},[]),o.useEffect(()=>{if(a>0){let t;return a>0&&(t=setInterval(()=>{n(r=>r<=1?(clearInterval(t),0):r-1)},1e3)),()=>clearInterval(t)}m(a===0)},[a]);const f=t=>{const r=Math.floor(t/60),s=t%60;return`${r}:${s<10?"0":""}${s}`};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"bg-[#c9d6ff] w-full h-screen bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center flex-col",children:e.jsxs("div",{className:"bg-[#fff] rounded-[30px] shadow-[0_5px_15px_rgba(0,0,0,0.35)] relative overflow-hidden w-[768px] max-w-[100%] min-h-[480px] py-6 px-3",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(R,{sx:{color:"rgb(198 173 138)",fontSize:"120px"},className:"border-[2px] rounded-full shadow-sm border-blue-500 p-3 mt-3",children:e.jsx(T,{})})}),e.jsxs("div",{className:"px-6",children:[e.jsx("h1",{className:"text-[30px] text-center mt-3 mb-3 font-bold",children:"Please confirm your email"}),e.jsxs("h3",{className:"text-[20px]",children:["Account username: ",c]}),e.jsxs("h3",{className:"text-[20px]",children:["The code has been sent to ",e.jsx("span",{className:"underline",children:i}),"."]}),e.jsxs("h3",{className:"text-[20px] mb-3",children:["Your code will expire in ",f(a)]}),e.jsxs("form",{onSubmit:j,className:"mb-3",children:[e.jsx(E,{error:!h,className:"w-full",children:e.jsx(C,{label:"Verify code",type:"text"})}),e.jsx(p,{variant:"contained",type:"submit",disabled:l,className:"mt-3 w-full",sx:{borderRadius:"30px"},children:"Confirm the code"})]}),e.jsx(p,{variant:"outlined",onClick:v,disabled:!l,className:"w-full",sx:{borderRadius:"30px"},children:l?"Send the code again":`Send the code again after ${f(a)}`})]})]})})})}catch{return e.jsx(e.Fragment,{children:e.jsx(I,{})})}}export{K as default};
