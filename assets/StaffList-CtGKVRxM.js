import{r as h,j as e,c as M,B as b}from"./index-VGU-9NUU.js";import{d as k}from"./Add-BQ9hSIbB.js";import{a as v}from"./instance-DZS3_tzi.js";import{a as C}from"./AxiosConfigHeader-CNHt4vQr.js";import{d as U}from"./MoreVert-CPftJ48K.js";import{T as F,a as E,b as x,c as B,d as D,e as R}from"./TableRow-C5qbdRgV.js";import{I as O}from"./IconButton-DWvNdrqB.js";import{P as _,F as W,S as $}from"./Select-l-UczRZW.js";import{M as g}from"./MenuItem-DiE26UUh.js";import{d as z}from"./Close-8usF18cr.js";import{m as A}from"./motion-ChqZ_GeW.js";import{T as j,F as V}from"./TextField-BbW75Pm-.js";import{B as y}from"./Button-1sJCo5hQ.js";import{g as Z,a as G,s as L,u as q,d as J,_ as S,e as K}from"./styled-C3jJ_e4t.js";import{S as Q}from"./Stack-lgF4DL-X.js";import{P as X}from"./Pagination-BT4a4nk-.js";import"./createSvgIcon-Bust3YDQ.js";import"./createSvgIcon-lFuL9lUi.js";import"./useId-S08-fgGb.js";import"./useIsFocusVisible-DwfdVPIc.js";import"./useControlled-uWKHelS5.js";import"./ButtonBase-CTLfAVod.js";import"./mergeSlotProps-CMtaL82j.js";import"./index-DxwPS3vl.js";import"./Grow-pPlLCpGJ.js";function Y(s){return Z("MuiTableHead",s)}G("MuiTableHead",["root"]);const ee=["className","component"],se=s=>{const{classes:t}=s;return K({root:["root"]},Y,t)},ae=L("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(s,t)=>t.root})({display:"table-header-group"}),re={variant:"head"},T="thead",te=h.forwardRef(function(t,n){const i=q({props:t,name:"MuiTableHead"}),{className:o,component:c=T}=i,p=J(i,ee),d=S({},i,{component:c}),m=se(d);return e.jsx(F.Provider,{value:re,children:e.jsx(ae,S({as:c,className:M(m.root,o),ref:n,role:c===T?null:"rowgroup",ownerState:d},p))})}),P=async({pageSize:s,page:t})=>{try{return(await v.get("/User",{axiosConfigHeader:C,params:{pageIndex:t,pageSize:s}})).data}catch(n){console.log(n)}},ne=async({payload:s,id:t})=>{try{const n=await v.patch("/User/ModifyAccount",s,{axiosConfigHeader:C,params:{userId:t}});b.success("Create success")}catch(n){console.log("Api Modify Staff Error: ",n),b.error("Create failure")}};function ie({data:s,setItemUpdate:t,setIsOpenUpdatePopup:n}){const[i,o]=h.useState(null),c=d=>{o(d.currentTarget)},p=()=>{o(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(E,{children:[e.jsx(x,{align:"left",children:s.name}),e.jsx(x,{align:"left",children:s.roleId==2?"Manager":s.roleId==3?"Design":s.roleId==4?"Production":s.roleId==5?"Sale":""}),e.jsx(x,{align:"left",children:s.email}),e.jsx(x,{align:"left",children:s.phone}),e.jsx(x,{children:e.jsx(O,{onClick:c,children:e.jsx(U,{})})})]}),e.jsx(_,{open:!!i,anchorEl:i,onClose:p,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:e.jsx(g,{onClick:()=>{t(s),n(!0),p()},children:"Edit"})})]})}const le=async({formData:s,accessToken:t})=>{try{let n=await v.post("/User/registerForAdmin",s,{axiosConfigHeader:C,params:{roleEnum:`${s.role}`}});b.success("Create success")}catch(n){console.log(">>> Error Api Create User: ",n),b.error("Create failure")}};function oe({setIsOpenPopup:s}){const[t,n]=h.useState({username:"",email:"",password:"",passwordConfirm:"",role:""}),[i,o]=h.useState({username:"",email:"",password:"",passwordConfirm:"",role:""}),c=l=>{const{name:a,value:r}=l.target;p(a,r)},p=(l,a)=>{let r="";switch(l){case"name":a.trim()===""&&(r="Name field cannot be blank");break;case"username":a.trim()===""&&(r="Username field cannot be blank");break;case"email":a.match("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,}$")||(r="Invalid email");break;case"password":a.trim()===""?r="Password field cannot be blank":/[A-Z]/.test(a)?/[a-z]/.test(a)?/\d/.test(a)?/[!@#$%^&*()]/.test(a)?a.length<12&&(r="Password must be at least 12 characters long!"):r="Password must contain at least one special character!":r="Password must contain at least one number!":r="Password must contain at least one lowercase letter!":r="Password must contain at least one uppercase letter!";break;case"confirm":a.trim()===""&&(r="Confirm Password field cannot be blank");break;case"role":a===""&&(r="Must choose a role");break}o({...i,[l]:r})},d=l=>{const{name:a,value:r}=l.target;n({...t,[a]:r})},m=async l=>{l.preventDefault();let a=!0,r={};Object.keys(t).forEach(f=>{t[f]===""&&(console.log(f),r[f]="Field cannot be blank",a=!1)}),o(r),a&&(await(async()=>{await le({formData:t})})(),console.log("Success"),s(!1))};return e.jsx(e.Fragment,{children:e.jsx("div",{onClick:()=>s(!1),className:"fixed top-0 right-0 left-0 bottom-0 bg-[rgba(0,0,0,0.6)] flex items-center justify-center",children:e.jsxs(A.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1,transition:{duration:.5}},onClick:l=>l.stopPropagation(),className:"bg-[#fff] w-[40rem] rounded-[10px] min-h-[450px]",children:[e.jsxs("div",{className:"relative text-center border-b-[1px] border-solid border-[#333] px-[1rem] py-[1rem] ",children:[e.jsx("h1",{className:"font-bold leading-5 text-[1.5rem]",children:"Add new staff"}),e.jsx("div",{onClick:()=>s(!1),className:"absolute top-[10px] right-[10px] cursor-pointer",children:e.jsx(z,{})})]}),e.jsxs("div",{className:"px-[1rem] py-[1rem]",children:[e.jsx("h2",{className:"text-[1.1rem] font-medium pb-[3px]",children:"Email"}),e.jsx("div",{children:e.jsx(j,{name:"email",value:t.name,onChange:d,onBlur:c,error:!!i.email,helperText:i.email,style:{width:"100%"},placeholder:"hung@gmail.com",id:"outlined-basic",variant:"outlined",size:"small",sx:{minHeight:"4rem"}})}),e.jsx("h2",{className:"text-[1.1rem] font-medium pb-[3px]",children:"Username"}),e.jsx("div",{children:e.jsx(j,{name:"username",onChange:d,onBlur:c,error:!!i.username,helperText:i.username,style:{width:"100%"},placeholder:"hungnd",id:"outlined-basic",variant:"outlined",size:"small",sx:{minHeight:"5.5rem"}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"w-[47%]",children:[e.jsx("h2",{className:"text-[1.1rem] font-medium pb-[3px]",children:"Password"}),e.jsx("div",{children:e.jsx(j,{name:"password",onChange:d,onBlur:c,error:!!i.password,helperText:i.password,style:{width:"100%"},placeholder:"hungnd",id:"outlined-basic",variant:"outlined",size:"small",sx:{minHeight:"5.5rem"}})})]}),e.jsxs("div",{className:"w-[47%]",children:[e.jsx("h2",{className:"text-[1.1rem] font-medium pb-[3px]",children:"Confirm Password"}),e.jsx("div",{children:e.jsx(j,{name:"passwordConfirm",onChange:d,onBlur:c,error:!!i.passwordConfirm,helperText:i.passwordConfirm,style:{width:"100%"},id:"outlined-basic",variant:"outlined",size:"small",sx:{minHeight:"5.5rem"}})})]})]}),e.jsxs("div",{className:"w-[100%]",children:[e.jsx("h2",{className:"text-[1.1rem] font-medium pb-[3px]",children:"Role"}),e.jsxs(W,{sx:{minWidth:120,width:"100%",minHeight:"4rem"},size:"small",error:!!i.role,children:[e.jsxs($,{value:t.role,name:"role",onChange:d,onBlur:c,displayEmpty:!0,inputProps:{"aria-label":"Without label"},children:[e.jsx(g,{value:"",children:e.jsx("em",{children:"None"})}),e.jsx(g,{value:2,children:"Manager"}),e.jsx(g,{value:5,children:"Sale Staff"}),e.jsx(g,{value:4,children:"Production Staff"}),e.jsx(g,{value:3,children:"Design Staff"})]}),i.role&&e.jsx(V,{children:i.role})]})]}),e.jsx("div",{className:"mt-[1rem]",children:e.jsxs(y,{onClick:m,variant:"contained",sx:{minWidth:"6rem"},children:[e.jsx(k,{fontSize:"small",sx:{marginRight:"8px"}}),"Add"]})})]})]})})})}function ce({data:s,setIsOpenUpdatePopup:t}){const[n,i]=h.useState({username:"",password:""}),[o,c]=h.useState({username:"",password:""}),p=m=>{const{name:l,value:a}=m.target;let r="",f=!0;try{(l=="username"||l=="password")&&(r="This field cannot be blank",a!==""&&(f=!1))}catch{f=!0}i({...n,[l]:a}),c({...o,[l]:f?r:""})},d=async()=>{let m=!0,l={};if(Object.keys(o).forEach(a=>{o[a]!==""&&(m=!1)}),Object.keys(n).forEach(a=>{n[a]===""&&(l[a]="This field cannot be blank",m=!1)}),c(l),m){let a=s.usersId,r=[{path:"username",op:"replace",value:n.username},{path:"password",op:"replace",value:n.password}];await ne({payload:r,id:a}),t(!1)}};return console.log(">>> data update staff :",s),e.jsx(e.Fragment,{children:e.jsx("div",{onClick:()=>t(!1),className:"fixed top-0 right-0 left-0 bottom-0 bg-[rgba(0,0,0,0.6)] flex items-center justify-center",children:e.jsxs(A.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1,transition:{duration:.5}},onClick:m=>m.stopPropagation(),className:"bg-[#fff] w-[40rem] rounded-[10px] min-h-[400px]",children:[e.jsxs("div",{className:"relative text-center border-b-[1px] border-solid border-[#333] px-[1rem] py-[1rem] ",children:[e.jsx("h1",{className:"font-bold leading-5 text-[1.5rem]",children:"Edit Staff Infomation"}),e.jsx("div",{onClick:()=>t(!1),className:"absolute top-[10px] right-[10px] cursor-pointer",children:e.jsx(z,{})})]}),e.jsxs("div",{className:"px-[1rem] py-[1rem]",children:[e.jsx("h2",{className:"text-[1.1rem] font-medium pb-[3px]",children:"Email"}),e.jsx("div",{children:e.jsx(j,{name:"email",value:s==null?void 0:s.email,style:{width:"100%"},disabled:!0,placeholder:"hung@gmail.com",id:"outlined-basic",variant:"outlined",size:"small",InputProps:{readOnly:!0}})}),e.jsxs("h2",{className:"text-[1.1rem] font-medium pb-[3px] mt-[1rem]",children:["Role : ",s.roleId==2?"Manager":s.roleId==3?"Design":s.roleId==4?"Production":s.roleId==5?"Sale":""]}),e.jsxs("div",{className:"flex items-center justify-between mt-[1rem]",children:[e.jsxs("div",{className:"w-[47%]",children:[e.jsx("h2",{className:"text-[1.1rem] font-medium pb-[3px]",children:"Username"}),e.jsx("div",{children:e.jsx(j,{name:"username",onChange:p,error:!!o.username,helperText:o.username,style:{width:"100%"},variant:"outlined",size:"small",sx:{minHeight:"5.5rem"}})})]}),e.jsxs("div",{className:"w-[47%]",children:[e.jsx("h2",{className:"text-[1.1rem] font-medium pb-[3px]",children:"Password"}),e.jsx("div",{children:e.jsx(j,{name:"password",onChange:p,error:!!o.password,helperText:o.password,style:{width:"100%"},variant:"outlined",size:"small",sx:{minHeight:"5.5rem"}})})]})]}),e.jsx("div",{className:"mt-[1rem]",children:e.jsx(y,{onClick:d,variant:"contained",sx:{minWidth:"6rem"},children:"Update"})})]})]})})})}function Ue(){const[t,n]=h.useState(!1),[i,o]=h.useState([]),[c,p]=h.useState(!1),[d,m]=h.useState(),[l,a]=h.useState(0),[r,f]=h.useState(1),N=async()=>{const u=await P({pageSize:6,page:r});o(u)},H=async()=>{const u=await P({});a(u==null?void 0:u.length)};h.useEffect(()=>{N(),H(),console.log("Check recall")},[t,r,c]);const I=(u,w)=>{f(w)};return console.log(">>>",t),console.log(r),console.log(i),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"py-[2rem] px-[2rem] ",children:[e.jsxs("div",{className:"flex items-center justify-between mb-[3rem]",children:[e.jsx("h4",{className:"text-[1.5rem] font-bold leading-[1.5]",children:"Staff List"}),e.jsx(y,{onClick:()=>n(!0),startIcon:e.jsx(k,{}),variant:"contained",children:"New Staff"})]}),e.jsx("div",{className:"min-h-[500px]",children:e.jsx("div",{children:e.jsx(B,{children:e.jsxs(D,{children:[e.jsx(te,{children:e.jsxs(E,{children:[e.jsx(x,{align:"left",children:"Name"}),e.jsx(x,{align:"left",children:"Role"}),e.jsx(x,{align:"left",children:"Email"}),e.jsx(x,{align:"left",children:"Phone"}),e.jsx(x,{align:"left"})]})}),e.jsx(R,{children:i.map((u,w)=>e.jsx(ie,{data:u,setItemUpdate:m,setIsOpenUpdatePopup:p},w))})]})})})}),e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(Q,{children:e.jsx(X,{count:Math.ceil(l/6)||0,page:r,onChange:I})})})]}),t&&e.jsx(oe,{setIsOpenPopup:n}),c&&e.jsx(ce,{setIsOpenUpdatePopup:p,data:d})]})}export{Ue as default};
